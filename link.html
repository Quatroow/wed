<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>DÃ¼ÄŸÃ¼n Linkleri YÃ¶netimi</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
</head>
<body>
  <div class="container">
    <h1>ðŸŽ‰ DÃ¼ÄŸÃ¼n Linkleri YÃ¶netimi</h1>

    <input type="text" id="weddingName" placeholder="DÃ¼ÄŸÃ¼n ID / Ä°smi (Ã¶rn: mehmet-elif)">
    <button onclick="addWedding()">âž• DÃ¼ÄŸÃ¼n Ekle</button>

    <table id="weddingTable">
      <thead>
        <tr>
          <th>DÃ¼ÄŸÃ¼n ID</th>
          <th>Davetli Linki</th>
          <th>Admin Linki</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    // ðŸ”¹ Firebase config
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const baseURL = window.location.origin;

    async function addWedding() {
      const name = document.getElementById("weddingName").value.trim();
      if (!name) return alert("LÃ¼tfen dÃ¼ÄŸÃ¼n ID girin!");

      // Firebase'de var mÄ± kontrol et
      const existing = await db.collection("weddings").doc(name).get();
      if (existing.exists) return alert("Bu dÃ¼ÄŸÃ¼n zaten ekli!");

      const guestLink = `${baseURL}/index.html?wedding=${name}`;
      const adminLink = `${baseURL}/admin.html?wedding=${name}`;

      await db.collection("weddings").doc(name).set({
        id: name,
        guestLink,
        adminLink,
        createdAt: firebase.firestore.Timestamp.now()
      });

      document.getElementById("weddingName").value = "";
      loadWeddings();
    }

    async function loadWeddings() {
      const tbody = document.querySelector("#weddingTable tbody");
      tbody.innerHTML = "";

      const snapshot = await db.collection("weddings").orderBy("createdAt", "desc").get();
      snapshot.forEach(doc => {
        const w = doc.data();
        const row = document.createElement("tr");
        row.innerHTML = `<td>${w.id}</td>
                         <td><a href="${w.guestLink}" target="_blank">${w.guestLink}</a></td>
                         <td><a href="${w.adminLink}" target="_blank">${w.adminLink}</a></td>`;
        tbody.appendChild(row);
      });
    }

    loadWeddings();
  </script>
</body>
</html>
